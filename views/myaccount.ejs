<%- include('./partials/header') %>

<% if (success && success.length > 0) { %>
  <div id="flash-message" class="fixed top-5 left-1/2 -translate-x-1/2 bg-green-500 text-white px-4 py-2 rounded shadow-lg text-sm z-50">
    <%= success[0] %>
  </div>
<% } %>

<% if (error && error.length > 0) { %>
  <div id="flash-message" class="fixed top-5 left-1/2 -translate-x-1/2 bg-red-500 text-white px-4 py-2 rounded shadow-lg text-sm z-50">
    <%= error[0] %>
  </div>
<% } %>

<body class="font-['helvetica_now_display']">
    <div class="w-full min-h-screen flex px-20 py-10 mt-10">
        
        <!-- Sidebar -->
        <div class="w-[25%] flex flex-col items-start pr-10">
            <div class="flex flex-col mb-10">
                <h3 class="text-lg font-semibold mb-3">My Account</h3>
                <a class="block w-fit mb-2 hover:underline" href="/shop">Shop</a>
                <a class="block w-fit mb-2 hover:underline" href="/users/myorders">My Orders</a>
                <a class="block w-fit mb-2 hover:underline" href="/users/account">My account</a>
                <a class="block w-fit mb-2 hover:underline text-red-600" href="/users/DeleteAccount">Delete account</a>                
            </div>
        </div>

        <!-- Main Content -->
        <div class="w-[75%]">
            <div class="max-w-lg w-full bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-semibold mb-6">Update Your Details</h2>
                
                <div class="mb-6">
                    <p class="text-gray-600"><strong>Name:</strong> <%= user.fullname %></p>
                    <p class="text-gray-600"><strong>Email:</strong> <%= user.email %></p>
                    <p class="text-gray-600"><strong>Contact:</strong> <%= user.contact %></p>
                </div>

                <form action="/changedetails" method="post" class="flex flex-col gap-4" onsubmit="" id="yourformId">
                    <input type="text" value="<%= user.fullname %>" name="fullname" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">
                    <input type="password" placeholder="Enter old password" name="oldpass" id="oldpass" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">
                    <input type="password" placeholder="Enter new password" name="newpass" id="pass1" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">
                    <input type="password" placeholder="Re-Enter the new password" name="confnewpass" id="pass2" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">
                    <input type="text" value="<%= user.contact %>" name="contact" id="contact" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">
                    <input type="text" value="<%= user.address %>" name="address" id="address" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">
                    <input type="number" value="<%= user.pincode %>" name="pincode" id="pincode" class="border px-3 py-2 rounded-md focus:outline-none focus:ring focus:ring-gray-300">    
                    <input type="submit" value="Update" class="bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 cursor-pointer transition">
                </form>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('yourformId').addEventListener('submit',function(event){
            const pass1=document.getElementById('pass1').value;
            const pass2=document.getElementById('pass2').value;
            const oldpass=document.getElementById('oldpass').value;


            if(oldpass===''){
                alert("Enter your old password");
                event.preventDefault();
            }

            if(pass1!=pass2){
                alert("Passwords doesnot match");
                event.preventDefault();
            }
        });
        const contact =document.getElementById('contact');
        if(!contact.value){
            contact.setAttribute('placeholder',"Enter your contact number");
        }
        const address =document.getElementById('address');
        if(!address.value){
            address.setAttribute('placeholder',"Enter your Address");
        }
        const pincode =document.getElementById('pincode');
        if(!pincode.value){
            pincode.setAttribute('placeholder',"Enter your Pincode");
        }
        
    </script>
</body>

<%- include('./partials/footer') %>
